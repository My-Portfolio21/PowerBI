bucket_name="your-bucket-name"
folder_name="ac"

# Get a list of subfolders
subfolders=$(aws s3 ls "s3://$bucket_name/$folder_name/" --recursive | awk -F '/' '{print $2}' | sort -u)

latest_subfolder=""
latest_timestamp=0

# Iterate through subfolders and find the latest modified timestamp
for subfolder in $subfolders; do
    timestamp=$(aws s3api list-objects-v2 --bucket "$bucket_name" --prefix "$folder_name/$subfolder/" --query "sort_by(Contents, &LastModified)[].LastModified" --output text --max-items 1)
    
    if [[ "$timestamp" != "" ]]; then
        unix_timestamp=$(date -d "$timestamp" "+%s")
        if ((unix_timestamp > latest_timestamp)); then
            latest_timestamp=$unix_timestamp
            latest_subfolder=$subfolder
        fi
    fi
done

echo "The most recently updated subfolder inside 'ac' is: $latest_subfolder"
