# Set the path to the source directory
SRCDIR="/datafiles/infadata/rf/salesrec/source/sterling/global/sales"

# List all CSV files in the SRCDIR, sort them by modification time (newest first), and select the latest file
latest_file=$(ls -t "$SRCDIR"/*.csv | head -1)

# Check if the latest file contains only a header row
if [[ $(tail -n +2 "$latest_file") ]]; then
  # The latest file contains data, proceed with your script logic
  echo "Data file found: $latest_file"
  # Add your processing logic here
else
  # The latest file contains only a header row
  echo "Empty file detected: $latest_file"
  # Send an email alert about the empty file
  EMAIL="your-email@example.com"
  echo "Subject: Empty File Alert - $(basename $latest_file)" | sendmail "$EMAIL"
  # Exit the script
  exit 1
fi
